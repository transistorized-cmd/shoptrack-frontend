const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index.js-lWhBEPWP.js","js/chart.js-Cq8dct2g.js","js/chunk-D50-beEz.js","js/chartjs.ts-bMp6mXne.js","js/index-BUkE986E.js","js/chunk-C1DHrtJO.js","css/index-DJGTRHid.css"])))=>i.map(i=>d[i]);
import{d as e,r as t,x as a,K as s,c as r,o as n,f as i,e as l,l as o,L as c,M as d,v as u,F as p,b as y,t as x,a as m,n as g,J as v,C as h,E as b,D as f,I as D,k}from"./chunk-D50-beEz.js";import{u as C}from"./chunk-CVCGJNZ4.js";import{c as w,_ as P}from"./index-BUkE986E.js";import"./chunk-C1DHrtJO.js";const F={class:"lazy-chart-container"},T={key:0,class:"flex items-center justify-center h-[200px] bg-gray-50 rounded-lg"},_={key:1,class:"chart-wrapper"},j={key:2,class:"flex items-center justify-center h-[200px] bg-red-50 rounded-lg"},H=P(e({__name:"LazyLineChart",props:{data:{},options:{},height:{}},emits:["chart:render"],setup(e,{emit:u}){const p=u,y=t(!0),x=t(!1),m=t(null),g=t(null),v=async()=>{y.value=!0,x.value=!1;try{const[{Line:e},{initializeChartJS:t}]=await Promise.all([w(()=>import("./index.js-lWhBEPWP.js"),__vite__mapDeps([0,1,2])),w(()=>import("./chartjs.ts-bMp6mXne.js"),__vite__mapDeps([3,4,2,5,6]))]);await t(),m.value=e,y.value=!1}catch(e){x.value=!0,y.value=!1}},h=e=>{g.value=e,p("chart:render",e)};return a(()=>{v()}),s(()=>{if(g.value){try{g.value.destroy()}catch(e){}g.value=null}}),(e,t)=>(n(),r("div",F,[y.value?(n(),r("div",T,[...t[0]||(t[0]=[l("div",{class:"flex items-center space-x-2 text-gray-500"},[l("div",{class:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"}),l("span",{class:"text-sm"},"Loading chart...")],-1)])])):m.value?(n(),r("div",_,[(n(),o(d(m.value),c({data:e.data,options:e.options,height:e.height},e.$attrs,{"onChart:render":h}),null,16,["data","options","height"]))])):x.value?(n(),r("div",j,[l("div",{class:"text-center"},[t[1]||(t[1]=l("p",{class:"text-sm text-red-600"},"Failed to load chart",-1)),l("button",{onClick:v,class:"mt-2 text-xs text-red-500 hover:text-red-700 underline"}," Retry ")])])):i("",!0)]))}}),[["__scopeId","data-v-6124885d"]]),E={class:"space-y-6"},R={key:0},A={class:"space-y-6"},S={class:"flex items-center justify-between mb-4"},$={class:"text-lg font-medium text-gray-900"},I={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},L={class:"text-right"},M={class:"text-xl font-bold text-gray-900"},V={class:"mb-4 grid grid-cols-2 gap-4 sm:grid-cols-4"},q={class:"text-center"},N={class:"text-sm font-medium text-gray-900"},O={class:"text-center"},z={class:"text-sm font-medium text-gray-900"},B={class:"text-center"},U={class:"text-sm font-medium text-gray-900"},W={class:"text-center"},J={class:"text-sm font-medium text-gray-900"},K={key:0,class:"mb-6"},Z={class:"bg-white p-4 border rounded-lg"},G={key:1},Q={class:"space-y-2"},X={class:"flex items-center space-x-4"},Y={class:"text-sm text-gray-600"},ee={class:"text-sm text-gray-500"},te={class:"flex items-center space-x-4"},ae={class:"text-right"},se={class:"text-sm font-medium text-gray-900"},re={key:0,class:"text-xs text-gray-500 block"},ne={class:"text-right min-w-[60px]"},ie={key:1,class:"text-center py-8"},le=e({__name:"PriceTrendsReport",props:{data:{}},setup(e){const a=t([]),o=t([]),c=e=>{e&&o.value.push(e)};s(()=>{o.value.forEach(e=>{try{e&&"function"==typeof e.destroy&&e.destroy()}catch(t){}}),a.value=[],o.value=[]});const d=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),v=(e,t)=>{if(0===t)return null;const a=e[t-1].averagePrice,s=e[t].averagePrice;return a&&0!==a?(s-a)/a*100:0},h=e=>null===e?"-":0===e?"0.0%":`${e>0?"+":""}${e.toFixed(1)}%`,b=u(()=>({responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},scales:{x:{title:{display:!0,text:"Date"},grid:{color:"#F3F4F6"}},y:{title:{display:!0,text:"Price ($)"},beginAtZero:!1,grid:{color:"#F3F4F6"}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return`$${e.parsed.y.toFixed(2)}`}}}},elements:{point:{radius:3,hoverRadius:5,borderWidth:2},line:{tension:.2,borderWidth:2}},animation:{duration:500},datasets:{line:{pointHoverRadius:6}}})),f=u(()=>{const e=new Map;return t=>{const a=`${t.itemName}-${t.priceHistory?.length||0}`;if(e.has(a))return e.get(a);if(!t.priceHistory||0===t.priceHistory.length){const t={labels:[],datasets:[]};return e.set(a,t),t}const s=t.priceHistory.map(e=>d(e.date)),r=t.priceHistory.map(e=>e.averagePrice),n={labels:s,datasets:[{label:t.itemName,data:r,borderColor:"#0EA5E9",backgroundColor:"rgba(14, 165, 233, 0.1)",borderWidth:2,fill:!1,pointBackgroundColor:"#0EA5E9",pointBorderColor:"#0284C7",pointBorderWidth:2,pointRadius:3,pointHoverRadius:5,tension:.2}]};return e.set(a,n),n}});return(e,t)=>(n(),r("div",E,[e.data.itemTrends&&e.data.itemTrends.length>0?(n(),r("div",R,[t[7]||(t[7]=l("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Price Trends",-1)),l("div",A,[(n(!0),r(p,null,y(e.data.itemTrends,e=>(n(),r("div",{key:e.itemName,class:"bg-white border rounded-lg p-4"},[l("div",S,[l("div",null,[l("h4",$,x(e.itemName),1),l("span",I,x(e.category),1)]),l("div",L,[t[0]||(t[0]=l("p",{class:"text-sm text-gray-500"},"Average Price",-1)),l("p",M," $"+x(e.overallAveragePrice?.toFixed(2)),1)])]),l("div",V,[l("div",q,[l("p",N," $"+x(e.minPrice?.toFixed(2)),1),t[1]||(t[1]=l("p",{class:"text-xs text-gray-500"},"Min Price",-1))]),l("div",O,[l("p",z," $"+x(e.maxPrice?.toFixed(2)),1),t[2]||(t[2]=l("p",{class:"text-xs text-gray-500"},"Max Price",-1))]),l("div",B,[l("p",U,x(e.priceVolatility?.toFixed(1))+"% ",1),t[3]||(t[3]=l("p",{class:"text-xs text-gray-500"},"Volatility",-1))]),l("div",W,[l("p",J,x(e.totalTransactions),1),t[4]||(t[4]=l("p",{class:"text-xs text-gray-500"},"Transactions",-1))])]),e.priceHistory&&e.priceHistory.length>1?(n(),r("div",K,[t[5]||(t[5]=l("h5",{class:"text-sm font-medium text-gray-700 mb-3"}," Price Trend Chart ",-1)),l("div",Z,[m(H,{ref_for:!0,ref_key:"chartRefs",ref:a,data:f.value(e),options:b.value,height:200,"onChart:render":c},null,8,["data","options"])])])):i("",!0),e.priceHistory&&e.priceHistory.length>0?(n(),r("div",G,[t[6]||(t[6]=l("h5",{class:"text-sm font-medium text-gray-700 mb-2"}," Price History ",-1)),l("div",Q,[(n(!0),r(p,null,y(e.priceHistory,(t,a)=>{return n(),r("div",{key:a,class:"flex items-center justify-between p-2 bg-gray-50 rounded"},[l("div",X,[l("span",Y,x(d(t.date)),1),l("span",ee,x(t.transactionCount)+" transactions",1)]),l("div",te,[l("div",ae,[l("span",se,"$"+x(t.averagePrice?.toFixed(2)),1),t.minPrice!==t.maxPrice?(n(),r("span",re," $"+x(t.minPrice?.toFixed(2))+" - $"+x(t.maxPrice?.toFixed(2)),1)):i("",!0)]),l("div",ne,[l("span",{class:g(["text-sm font-medium",(s=v(e.priceHistory,a),null===s||0===s?"text-gray-500":s>0?"text-red-600":"text-green-600")])},x(h(v(e.priceHistory,a))),3)])])]);var s}),128))])])):i("",!0)]))),128))])])):i("",!0),e.data.itemTrends&&0!==e.data.itemTrends.length?i("",!0):(n(),r("div",ie,[...t[8]||(t[8]=[l("p",{class:"text-gray-500"}," No price trend data available for the selected period ",-1),l("p",{class:"text-xs text-gray-400 mt-2"}," Items need multiple purchase transactions to show trends ",-1)])]))]))}}),oe={class:"space-y-6"},ce={class:"flex items-center justify-between"},de={key:0,class:"flex space-x-2"},ue=["disabled"],pe=["disabled"],ye={class:"bg-white p-4 rounded-lg border space-y-4"},xe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},me=["value"],ge={class:"flex justify-between items-center"},ve=["disabled"],he={key:0,class:"text-center py-12"},be={key:1,class:"text-center py-12"},fe={class:"text-red-600 mb-4"},De={key:2},ke={key:3,class:"text-center py-12"},Ce=e({__name:"PriceTrends",setup(e){const s=D(),o=k(),c=C(),d=t(!1),u=t(null),g=t(null),w=t(null),P=v({startDate:"",endDate:"",category:""}),F=t(["Food","Electronics","Clothing","Household","Health","Transportation"]),T=()=>{const e={};P.startDate&&(e.startDate=P.startDate),P.endDate&&(e.endDate=P.endDate),P.category&&(e.category=P.category),o.replace({query:e})},_=async()=>{d.value=!0,u.value=null;try{const e=P.startDate&&P.endDate?{startDate:P.startDate,endDate:P.endDate}:void 0,t={};P.category&&(t.category=P.category);const a={pluginKey:"price-trends",dateRange:e,parameters:t};w.value=await c.generateReport(a)}catch(e){u.value=e instanceof Error?e.message:"Failed to load price trends data"}finally{d.value=!1}},j=async e=>{g.value=e;try{const t=P.startDate&&P.endDate?{startDate:P.startDate,endDate:P.endDate}:void 0,a={};P.category&&(a.category=P.category);const s={pluginKey:"price-trends",dateRange:t,parameters:a};await c.exportReport(s,e)}catch(t){}finally{g.value=null}},H=()=>{T()},E=()=>{_()},R=()=>{P.startDate="",P.endDate="",P.category="";const e=new Date,t=new Date;t.setMonth(e.getMonth()-6),P.startDate=t.toISOString().split("T")[0],P.endDate=e.toISOString().split("T")[0],T(),_()};return a(()=>{(()=>{if(s.query.startDate)P.startDate=s.query.startDate;else{const e=new Date,t=new Date;t.setMonth(e.getMonth()-6),P.startDate=t.toISOString().split("T")[0]}s.query.endDate?P.endDate=s.query.endDate:P.endDate=(new Date).toISOString().split("T")[0],s.query.category&&(P.category=s.query.category)})(),_()}),(e,t)=>(n(),r("div",oe,[l("div",ce,[t[5]||(t[5]=l("div",null,[l("h1",{class:"text-2xl font-bold text-gray-900"},"Price Trends Analysis"),l("p",{class:"text-gray-600 mt-1"}," Track price patterns and volatility for items over time ")],-1)),w.value&&w.value.data.itemTrends?.length>0?(n(),r("div",de,[l("button",{disabled:"csv"===g.value,class:"btn btn-secondary text-sm",onClick:t[0]||(t[0]=e=>j("csv"))},x("csv"===g.value?"Exporting...":"Export CSV"),9,ue),l("button",{disabled:"json"===g.value,class:"btn btn-secondary text-sm",onClick:t[1]||(t[1]=e=>j("json"))},x("json"===g.value?"Exporting...":"Export JSON"),9,pe)])):i("",!0)]),l("div",ye,[l("div",xe,[l("div",null,[t[6]||(t[6]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Start Date",-1)),h(l("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>P.startDate=e),type:"date",class:"input",onChange:H},null,544),[[b,P.startDate]])]),l("div",null,[t[7]||(t[7]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"End Date",-1)),h(l("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>P.endDate=e),type:"date",class:"input",onChange:H},null,544),[[b,P.endDate]])]),l("div",null,[t[9]||(t[9]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),h(l("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>P.category=e),class:"input",onChange:H},[t[8]||(t[8]=l("option",{value:""},"All Categories",-1)),(n(!0),r(p,null,y(F.value,e=>(n(),r("option",{key:e,value:e},x(e),9,me))),128))],544),[[f,P.category]])])]),l("div",ge,[l("button",{class:"btn btn-secondary text-sm",onClick:R}," Reset Filters "),l("button",{disabled:d.value,class:"btn btn-primary text-sm",onClick:E},x(d.value?"Loading...":"Apply Filters"),9,ve)])]),d.value?(n(),r("div",he,[...t[10]||(t[10]=[l("div",{class:"inline-flex items-center space-x-2 text-gray-500"},[l("svg",{class:"animate-spin h-6 w-6",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),l("span",null,"Analyzing price trends...")],-1)])])):u.value?(n(),r("div",be,[l("p",fe,x(u.value),1),l("button",{class:"btn btn-primary",onClick:_},"Retry")])):w.value?(n(),r("div",De,[m(le,{data:w.value.data},null,8,["data"])])):(n(),r("div",ke,[...t[11]||(t[11]=[l("p",{class:"text-gray-500 mb-4"},"No price trend data available",-1),l("p",{class:"text-sm text-gray-400"},"Adjust your filters and try again",-1)])]))]))}});export{Ce as default};
