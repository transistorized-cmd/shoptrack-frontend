import{d as e,J as t,x as a,c as s,o as r,e as n,f as l,F as i,b as c,u as o,H as p,t as d,k as y}from"./chunk-D50-beEz.js";import{a as u}from"./index-BUkE986E.js";import{u as g}from"./chunk-CVCGJNZ4.js";import"./chunk-C1DHrtJO.js";const x={class:"space-y-6"},m={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},k={class:"flex items-start justify-between mb-4"},v={class:"flex items-center"},D={class:"ml-4"},b={class:"text-lg font-medium text-gray-900"},h={class:"text-sm text-gray-500"},f={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},w={class:"mb-6 space-y-2 text-sm text-gray-600"},R={class:"flex items-center"},C={class:"flex items-center"},q={key:0,class:"flex items-center"},j={key:0,class:"mb-4"},E={class:"grid grid-cols-2 gap-3"},I=["value","onInput"],S=["value","onInput"],F={class:"flex items-center justify-between"},A=["disabled","onClick"],P={key:0,class:"flex space-x-2"},z=["disabled","onClick"],G={key:1,class:"mt-4 text-center py-4"},M={class:"inline-flex items-center space-x-2 text-sm text-gray-500"},N={key:2,class:"mt-6 space-y-4"},O={class:"border-t border-gray-200 pt-4"},H={class:"text-sm font-medium text-gray-900 mb-3"},J={class:"bg-gray-50 p-4 rounded-lg"},K={class:"text-xs text-gray-600 whitespace-pre-wrap"},T={key:0,class:"text-center py-12"},U=e({__name:"Reports",setup(e){const U=y(),V=u(),_=g(),B=t({}),L=t({}),Q=t({}),W=(e,t,a)=>{B[e]||(B[e]={startDate:"",endDate:""}),B[e][t]=a},X=e=>{const t=B[e];return t&&t.startDate&&t.endDate&&t.startDate<=t.endDate};return a(async()=>{await V.fetchAllPlugins(),V.enabledReportPlugins.forEach(e=>{if(e.requiresDateRange){const t=new Date,a=new Date;a.setMonth(t.getMonth()-1),B[e.key]={startDate:a.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0]}}})}),(e,t)=>(r(),s("div",x,[t[6]||(t[6]=n("div",null,[n("h1",{class:"text-2xl font-bold text-gray-900"},"Reports & Analytics"),n("p",{class:"text-gray-600 mt-1"}," Analyze your spending patterns and track receipt insights ")],-1)),n("div",m,[(r(!0),s(i,null,c(o(V).enabledReportPlugins,e=>(r(),s("div",{key:e.key,class:"card p-6"},[n("div",k,[n("div",v,[n("div",{class:"w-12 h-12 rounded-lg flex items-center justify-center text-white text-xl",style:p({backgroundColor:e.color})},d(e.icon),5),n("div",D,[n("h3",b,d(e.name),1),n("p",h,d(e.description),1)])]),n("span",f,d(e.category),1)]),n("div",w,[n("div",R,[t[0]||(t[0]=n("span",{class:"w-4 h-4 mr-2"},"ðŸ“…",-1)),n("span",null,d(e.requiresDateRange?"Date range required":"No date range required"),1)]),n("div",C,[t[1]||(t[1]=n("span",{class:"w-4 h-4 mr-2"},"ðŸ“Š",-1)),n("span",null,d(e.supportsExport?"Export supported":"View only"),1)]),e.supportedExportFormats.length>0?(r(),s("div",q,[t[2]||(t[2]=n("span",{class:"w-4 h-4 mr-2"},"ðŸ’¾",-1)),n("span",null,"Formats: "+d(e.supportedExportFormats.join(", ").toUpperCase()),1)])):l("",!0)]),e.requiresDateRange?(r(),s("div",j,[t[3]||(t[3]=n("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date Range",-1)),n("div",E,[n("input",{type:"date",value:B[e.key]?.startDate||"",class:"input text-sm",placeholder:"Start Date",onInput:t=>W(e.key,"startDate",t.target?.value)},null,40,I),n("input",{type:"date",value:B[e.key]?.endDate||"",class:"input text-sm",placeholder:"End Date",onInput:t=>W(e.key,"endDate",t.target?.value)},null,40,S)])])):l("",!0),n("div",F,[n("button",{disabled:e.requiresDateRange&&!X(e.key),class:"btn btn-primary text-sm disabled:opacity-50",onClick:t=>(async e=>{if("category-analytics"===e.key){const t={},a=B[e.key];return a&&a.startDate&&(t.startDate=a.startDate),a&&a.endDate&&(t.endDate=a.endDate),void U.push({path:"/analytics/categories",query:t})}if("price-trends"===e.key){const t={},a=B[e.key];return a&&a.startDate&&(t.startDate=a.startDate),a&&a.endDate&&(t.endDate=a.endDate),void U.push({path:"/analytics/price-trends",query:t})}L[e.key]=!0;try{const t={pluginKey:e.key,dateRange:e.requiresDateRange?B[e.key]:void 0,parameters:{}},a=await _.generateReport(t);Q[e.key]=a}catch(t){}finally{L[e.key]=!1}})(e)},d(L[e.key]?"Generating...":"Generate Report"),9,A),e.supportsExport?(r(),s("div",P,[(r(!0),s(i,null,c(e.supportedExportFormats,t=>(r(),s("button",{key:t,disabled:!Q[e.key],class:"btn btn-secondary text-xs disabled:opacity-50",onClick:a=>(async(e,t)=>{try{const a={pluginKey:e.key,dateRange:e.requiresDateRange?B[e.key]:void 0,parameters:{}};await _.exportReport(a,t)}catch(a){}})(e,t)},d(t.toUpperCase()),9,z))),128))])):l("",!0)]),L[e.key]?(r(),s("div",G,[n("div",M,[t[4]||(t[4]=n("svg",{class:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),n("span",null,"Generating "+d(e.name.toLowerCase())+"...",1)])])):Q[e.key]&&!["category-analytics","price-trends"].includes(e.key)?(r(),s("div",N,[n("div",O,[n("h4",H,d(Q[e.key].title),1),n("div",J,[n("pre",K,d(JSON.stringify(Q[e.key].data,null,2)),1)])])])):l("",!0)]))),128))]),0===o(V).enabledReportPlugins.length?(r(),s("div",T,[...t[5]||(t[5]=[n("div",{class:"text-gray-500 mb-4"},"No report plugins available",-1),n("p",{class:"text-sm text-gray-400"}," Report plugins will appear here when they are enabled ",-1)])])):l("",!0)]))}});export{U as default};
