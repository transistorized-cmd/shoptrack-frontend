import{s as e,r as a}from"./chunk-D50-beEz.js";import{d as r}from"./index-BUkE986E.js";const t=async e=>(await r.post(`/reports/${e.pluginKey}/generate`,{dateRange:e.dateRange,parameters:e.parameters})).data,n=async(e,a)=>(await r.post(`/reports/${e.pluginKey}/export`,{dateRange:e.dateRange,parameters:e.parameters},{params:{format:a},responseType:"blob"})).data,o=e("reports",()=>{const e=a(new Map),r=a(!1),o=a(null),l=a(null);return{reports:e,loading:r,error:o,currentReport:l,generateReport:async a=>{r.value=!0,o.value=null;try{const r=await t(a),n=`${a.pluginKey}-${JSON.stringify(a.dateRange)}-${JSON.stringify(a.parameters)}`;return e.value.set(n,r),l.value=r,r}catch(n){throw o.value=n instanceof Error?n.message:"Failed to generate report",n}finally{r.value=!1}},exportReport:async(e,a)=>{r.value=!0,o.value=null;try{const r=await n(e,a),t=window.URL.createObjectURL(r),o=document.createElement("a");o.href=t,o.download=`${e.pluginKey}-report.${a}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(t)}catch(t){throw o.value=t instanceof Error?t.message:"Failed to export report",t}finally{r.value=!1}},getCachedReport:a=>{const r=`${a.pluginKey}-${JSON.stringify(a.dateRange)}-${JSON.stringify(a.parameters)}`;return e.value.get(r)},clearCache:()=>{e.value.clear()},clearError:()=>{o.value=null},clearCurrentReport:()=>{l.value=null}}});export{o as u};
